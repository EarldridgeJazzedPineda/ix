#!/usr/bin/env sh

set -xue

cd $(dirname ${IX_BINARY})

curl -k 'https://repology.org/api/v1/projects/?maintainer=anton%40samokhvalov.xyz&outdated=1' | ix_flt | grep -v apr | grep -v qt | grep -v vulkan | grep -v mesa | grep -v spirv | grep -v freeglut | grep -v gdk | grep -v gstr | grep -v libgpg | grep -v make | grep -v 'bld/' | grep -v meson | grep -v musl | grep -v python | grep -v perl | grep -v poppler | grep -v postgre | grep -v readline | grep -v rio | grep -v ruby | grep -v scons | grep -v sdbus | grep -v vim | while read l; do
    echo ${l}

    if ix_up ${l}; then
        git add -A
        git commit -m "up" || true
    else
        git checkout .
    fi
done
